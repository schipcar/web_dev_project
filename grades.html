<!DOCTYPE html>
<html>

<head>
  <link rel=stylesheet href="canvas_styles.css" TYPE="text/css">
  <script src="canvas_functions.js"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Assignments</title>
</head>


<body>

  <div id="header">
    <h2 id="Grades_title">Grades</h2>
  </div>


<div id="demo">
<button type="button" onclick="LoadAllGrades()">Load Grades</button>
</div>
<div id="dinamic">
</div>

<script>
var counter = 0;
var Preferences = 0;
var nrows = 0;
Preferences.id = "tbl";


function LoadAllGrades() {
  var xhttp = new XMLHttpRequest();
  xhttp.open("GET", "http://localhost:8080/getdictionary", true);
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
           var dict_all = JSON.parse(this.responseText);
           console.log(dict_all)
           var list_array = new Array();
           for (var i=0; i<dict_all.length; i++) {
             const dict_t = dict_all[i];
             console.log(dict_t)
             const array1 = [dict_t.student, dict_t.name, dict_t.status, dict_t.punctuation, dict_t.possible];
             list_array.push(array1)}
             nrows = dict_all.length
          createtable("tbl", list_array, nrows);}
   }
   xhttp.send();
}




createtable = function(id, list_array, nrows){
    var TableDiv = document.getElementById("dinamic");  
    var ncells = 5;
    var names = ["Student", "Name", "Status", "Punctuation", "Possible"];
    
    var table = document.createElement('TABLE');
    table.border='1';
    var tableBody = document.createElement('TBODY');
    table.appendChild(tableBody);
    table.id = id
    var header = table.createTHead();
    var row = header.insertRow(0);
    
    for (var p=0; p<5; p++){
           var cell = row.insertCell(p);
           cell.innerHTML = names[p];
    }

    for (var i=0; i<nrows; i++){
       var tr = document.createElement('TR');
       tableBody.appendChild(tr);
       
       for (var j=0; j<ncells; j++){
           var td = document.createElement('TD');
           console.log(list_array[i])
           td.appendChild(document.createTextNode(String(list_array[i][j])));
           tr.appendChild(td);
       }
    }
    Preferences = table;
    TableDiv.appendChild(table)   
}


</script>
</body>
</html>